<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    
    <!-- Leaflet configuration -->
    <script>
        L_NO_TOUCH = false;
        L_DISABLE_3D = false;
    </script>
    
    <style>html, body {width: 100%; height: 100%; margin: 0; padding: 0;}</style>
    <style>#map {position: absolute; top: 0; bottom: 0; right: 0; left: 0;}</style>
    
    <!-- External JS and CSS Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css"/>

    <!-- Responsive design -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
    <style>
        #map_806ce94db0dd4fddb38420c9ea0cea7e {
            position: relative;
            width: 100.0%;
            height: 100.0%;
            left: 0.0%;
            top: 0.0%;
        }
        .leaflet-container { font-size: 1rem; }
    </style>
    
    <title>Interactive Climbing Tracks Map</title>
</head>

<body>
    <div id="map_806ce94db0dd4fddb38420c9ea0cea7e"></div>

    <!-- Leaflet Map Script -->
    <script>
        // Initialize the map with default view
        var map = L.map('map_806ce94db0dd4fddb38420c9ea0cea7e').setView([37.7749, -122.4194], 5);

        // Add OpenStreetMap tiles to the map
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Function to load GeoJSON files and create toggle layer control
        function loadGeoJSONTrack(url, map, overlayMaps, layerName) {
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    var geojsonLayer = L.geoJSON(data, {
                        style: function (feature) {
                            return {
                                color: "#ff7800",  // Customize track color if needed
                                weight: 5,
                                opacity: 0.65
                            };
                        }
                    });
                    
                    // Add the layer to the map
                    geojsonLayer.addTo(map);
                    
                    // Add the layer to the overlay control for toggling
                    overlayMaps[layerName] = geojsonLayer;
                })
                .catch(err => console.error("Failed to load GeoJSON file:", url, err));
        }

        // Overlay Maps for holding toggleable layers
        var overlayMaps = {};

        // List of GeoJSON files to load (replace with your tracks)
        const geoJSONFiles = [
            'assets/tracks/watchtower.geojson'
        ];

        // Load all tracks into the map and layer control
        geoJSONFiles.forEach(function (file, index) {
            loadGeoJSONTrack(file, map, overlayMaps, "Track " + (index + 1));
        });

        // Add layer control to the map for toggling tracks on/off
        L.control.layers(null, overlayMaps, {collapsed: false}).addTo(map);
    </script>
</body>
</html>
